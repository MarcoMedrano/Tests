<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="css/style.css" type="text/css" media="all" />

    <script src="libs/resampler.js"></script>
    <script src="libs/XAudioServer.js"></script>
    <script src="libs/gsm.js"></script>
    <script src="libs/WaveParser.js"></script>

    <script src="GsmDecoder.js"></script>
    <script src="FileLoader.js"></script>
    <script src="XAudioPlayer.js"></script>
    <script src="AudioContextPlayer.js"></script>

</head>
<body style="padding: 20px; font-family: 'Comic Sans MS'; font-size: 110%;">
<br>
<div>
    <h2>Files</h2><br>
    <input type='radio' name='file' value='/res/gsm-mono.wav' checked> /res/gsm-mono.wav<br>
    <input type='radio' name='file' value='/res/pcm-mono.wav'> /res/pcm-mono.wav<br>
    <input type='radio' name='file' value='/res/pcm-stereo.wav'> /res/pcm-stereo.wav<br>
    <input type='radio' name='file' value='/res/pcm-stereo2.wav'> /res/pcm-stereo2.wav<br>
    <input type='radio' name='file' value='/res/pcm-stereo3.wav'> /res/pcm-stereo3.wav<br>
</div>
<br><br>
<div>
    <h2>Players</h2><br>
    <input type='radio' name='player' value='XAudio' checked> XAudio<br>
    <input type='radio' name='player' value='AudioContext'> AudioContext<br>
</div>
<br><br>
<button id='playstop' onclick="play()" type="button" autofocus="autofocus" style="padding: 5px; font-size: 140%;">►</button>
    <!--»-->
<script>

    var playing = false;
    var player = {};//Current player 

    function play() {

        document.querySelector('button[id="playstop"]').innerText = !playing ? " ■ " : "►";

        if (playing) {
            player.stop();
            playing = false;

            return;
        }
        var audioFileUrl = document.querySelector('input[name="file"]:checked').value;

        new FileLoader().load(audioFileUrl, function(buffer) {
            player = document.querySelector('input[name="player"]:checked').value == 'XAudio' ? new XAudioPlayer(buffer, onEnded) : new AudioContextPlayer(buffer, onEnded);
            playing = true;

            player.play();
        }
        );
    };

    function onEnded() {
        playing = false;
        document.querySelector('button[id="playstop"]').innerText = "►";
    }
</script>



</body>
</html>